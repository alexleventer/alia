<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>qbits.alia documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Alia-all</span> <span class="project-version">4.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>qbits</span></div></div></li><li class="depth-2 current"><a href="qbits.alia.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>alia</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>async</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.cluster-options.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cluster-options</span></div></a></li><li class="depth-3"><a href="qbits.alia.codec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>codec</span></div></a></li><li class="depth-4 branch"><a href="qbits.alia.codec.default.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>default</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extension</span></div></div></li><li class="depth-5"><a href="qbits.alia.codec.extension.joda-time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>joda-time</span></div></a></li><li class="depth-4"><a href="qbits.alia.codec.udt-aware.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>udt-aware</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.enum.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>enum</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.manifold.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>manifold</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>policy</span></div></div></li><li class="depth-4 branch"><a href="qbits.alia.policy.address-translator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>address-translator</span></div></a></li><li class="depth-4 branch"><a href="qbits.alia.policy.load-balancing.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>load-balancing</span></div></a></li><li class="depth-4 branch"><a href="qbits.alia.policy.reconnection.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>reconnection</span></div></a></li><li class="depth-4 branch"><a href="qbits.alia.policy.retry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>retry</span></div></a></li><li class="depth-4"><a href="qbits.alia.policy.speculative-execution.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>speculative-execution</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.query-logger.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>query-logger</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.timestamp-generator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>timestamp-generator</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.tuple.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tuple</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.udt.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>udt</span></div></a></li><li class="depth-3"><a href="qbits.alia.uuid.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>uuid</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="qbits.alia.html#var-batch"><div class="inner"><span>batch</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-bind"><div class="inner"><span>bind</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-cluster"><div class="inner"><span>cluster</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-connect"><div class="inner"><span>connect</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-execute"><div class="inner"><span>execute</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-execute-async"><div class="inner"><span>execute-async</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-lazy-query"><div class="inner"><span>lazy-query</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-prepare"><div class="inner"><span>prepare</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-register.21"><div class="inner"><span>register!</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-shutdown"><div class="inner"><span>shutdown</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-tuple-encoder"><div class="inner"><span>tuple-encoder</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-udt-encoder"><div class="inner"><span>udt-encoder</span></div></a></li><li class="depth-1"><a href="qbits.alia.html#var-unregister.21"><div class="inner"><span>unregister!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">qbits.alia</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-batch"><h3>batch</h3><div class="usage"><code>(batch qs)</code><code>(batch qs type)</code><code>(batch qs type codec)</code></div><div class="doc"><div class="markdown"><p>Takes a sequence of statements to be executed in batch. By default LOGGED, you can specify :logged :unlogged :counter as an optional second argument to control the type. It also accepts an optional third argument, codec instance (see <code>execute</code>)</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L369">view source</a></div></div><div class="public anchor" id="var-bind"><h3>bind</h3><div class="usage"><code>(bind statement values)</code><code>(bind statement values {:keys [encoder]})</code></div><div class="doc"><div class="markdown"><p>Takes a statement and a collection of values and returns a com.datastax.driver.core.BoundStatement instance to be used with <code>execute</code> (or one of its variants)</p>
<p>Where values:  Map: for named bindings (i.e. INSERT INTO table (id, date) VALUES (:id :date))  List: for positional bindings (i.e. INSERT INTO table (id, date) VALUES (?, ?))</p>
<p>It also accepts an optional third argument, codec instance (see <code>execute</code>)</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L292">view source</a></div></div><div class="public anchor" id="var-cluster"><h3>cluster</h3><div class="usage"><code>(cluster options)</code><code>(cluster)</code></div><div class="doc"><div class="markdown"><p>Takes an option map and returns a new  com.datastax.driver.core/Cluster instance.</p>
<p>The following options are supported:</p>
<ul>
  <li>
  <p><code>:contact-points</code> : List of nodes ip addresses to connect to.</p></li>
  <li>
  <p><code>:port</code> : port to connect to on the nodes (native transport must be  active on the nodes: <code>start_native_transport: true</code> in  cassandra.yaml). Defaults to 9042 if not supplied.</p></li>
  <li>
    <p><code>:load-balancing-policy</code> : Configure the  <a href="http://mpenet.github.io/alia/qbits.alia.policy.load-balancing.html">Load Balancing Policy</a>  to use for the new cluster.</p>
    <ul>
      <li>Can be a one of
        <ul>
          <li><code>LoadBalancingPolicy</code> instance</li>
          <li><code>:default</code></li>
          <li><code>:round-robin</code></li>
          <li><code>:token-aware/round-robin</code></li>
          <li><code>:latency-aware/round-robin</code></li>
        </ul>
      </li>
      <li>or a map of
        <ul>
          <li><code>:type</code> : <code>:whitelist</code> or <code>:token-aware/whitelist</code></li>
          <li><code>:child</code> : Keyword or map (other load balancing policy configuration)</li>
          <li><code>:whitelist : Seq of maps of</code>:hostname<code>String
</code>:port<code>int
                        or</code>:ip<code>String
</code>:port<code>int
                        or</code>:port` int</li>
        </ul>
      </li>
      <li>or a map of
        <ul>
          <li><code>:type</code> : <code>:latency-aware/white-list</code></li>
          <li><code>:child</code> : Same as above</li>
          <li>`:whitelist : Same as above</li>
          <li><code>:exclusion-threshold</code> : double</li>
          <li><code>:min-measure</code> : int</li>
          <li><code>:retry-period</code> : [long (time-unit Keyword)]</li>
          <li><code>:scale</code> : [long (time-unit Keyword)]</li>
          <li><code>:update-rate</code> : [long (time-unit Keyword)]</li>
        </ul>
      </li>
      <li>or a map of
        <ul>
          <li><code>:type</code> : <code>:dc-aware-round-robin</code>, <code>:token-aware/dc-aware-round-robin</code></li>
          <li><code>:data-centre</code> : String</li>
          <li><code>:used-hosts-per-remote-dc</code> : int</li>
        </ul>
      </li>
      <li>or a map of
        <ul>
          <li><code>:type</code> : <code>:latency-aware/dc-aware-round-robin</code></li>
          <li><code>:data-centre</code> : String</li>
          <li><code>:used-hosts-per-remote-dc</code> : int</li>
          <li><code>:exclusion-threshold</code> : double</li>
          <li><code>:min-measure</code> : int</li>
          <li><code>:retry-period</code> : [long (time-unit Keyword)]</li>
          <li><code>:scale</code> : [long (time-unit Keyword)]</li>
          <li><code>:update-rate</code> : [long (time-unit Keyword)]</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p><code>:reconnection-policy</code> : Configure the  <a href="http://mpenet.github.io/alia/qbits.alia.policy.reconnection.html">Reconnection Policy</a>  to use for the new cluster.</p>
    <ul>
      <li>Can be
        <ul>
          <li><code>ReconnectionPolicy</code></li>
          <li><code>:default</code></li>
        </ul>
      </li>
      <li>or a map of
        <ul>
          <li><code>:type</code> <code>:constant</code></li>
          <li><code>:contant-delay-ms</code> long</li>
        </ul>
      </li>
      <li>or a map of
        <ul>
          <li><code>:type</code> <code>:exponential</code></li>
          <li><code>:base-delay-ms</code> long</li>
          <li><code>:max-delay-ms</code> long</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p><code>:retry-policy</code> : Configure the  <a href="http://mpenet.github.io/alia/qbits.alia.policy.retry.html">Retry Policy</a>  to use for the new cluster.</p>
    <ul>
      <li>Can be
        <ul>
          <li><code>RetryPolicy</code>,</li>
          <li><code>:default</code></li>
          <li><code>:fallthrough</code></li>
          <li><code>:downgrading</code></li>
          <li><code>:logging/default</code></li>
          <li><code>:logging/fallthrough</code></li>
          <li><code>:logging/downgrading</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p><code>:speculative-execution</code> The policy that decides if the driver will  send speculative queries to the next hosts when the current host  takes too long to respond. <a href="http://mpenet.github.io/alia/qbits.alia.policy.speculative-execution.html">Speculative Execution  Policy</a></p>
    <ul>
      <li>Can be
        <ul>
          <li><code>SpeculativeExecutionPolicy</code></li>
          <li><code>:default</code></li>
          <li><code>:none</code></li>
        </ul>
      </li>
      <li>or a map of
        <ul>
          <li><code>:type</code> : <code>:constant</code></li>
          <li><code>:constant-delay-millis</code> : long</li>
          <li><code>:max-speculative-executions</code> : int</li>
        </ul>
      </li>
      <li>or
        <ul>
          <li><code>:type</code> : <code>:cluster-wide-percentile-tracker</code> or <code>:per-host-percentile-tracker</code></li>
          <li><code>:percentile</code> : double</li>
          <li>`:max-executions : int</li>
          <li><code>:interval</code> : [long (time-unit Keyword)]</li>
          <li><code>:min-recorded-values</code> : int</li>
          <li><code>:significant-value-digits</code> : int</li>
          <li><code>:highest-trackable-latency-millis</code> : long</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
  <p><code>:metrics?</code> : Toggles metrics collection for the created cluster  (metrics are enabled by default otherwise).</p></li>
  <li>
  <p><code>:jmx-reporting?</code> : Toggles JMX reporting of the metrics.</p></li>
  <li>
  <p><code>:credentials</code> : Takes a map of :user and :password for use with  Cassandra’s PasswordAuthenticator</p></li>
  <li>
  <p><code>:compression</code> : Compression supported by the Cassandra binary  protocol. Can be <code>:none</code>, <code>:snappy</code> or <code>:lz4</code>.</p></li>
  <li>
  <p><code>:cluster-name</code> : Optional name for create cluster</p></li>
  <li>
  <p><code>max-schema-aggreement-wait-seconds</code> Sets the maximum time to wait  for schema agreement before returning from a DDL query.</p></li>
  <li>
  <p><code>:netty-options</code>: (advanced) see  <a href="http://docs.datastax.com/en/drivers/java/2.1/com/datastax/driver/core/NettyOptions.html">http://docs.datastax.com/en/drivers/java/2.1/com/datastax/driver/core/NettyOptions.html</a></p></li>
  <li>
  <p><code>:address-translator</code>: Configures the address translator to use for  the new cluster. Expects  a <a href="http://mpenet.github.io/alia/qbits.alia.policy.address-translator.html">AddressTranslator</a>  or you can pass :ec2-multi-region or :identity which would translate in the  underlying implementations.</p></li>
  <li>
  <p><code>:timestamp-generator</code>: Configures the timestamp generator to use  with the new cluster. Expects  a <a href="http://mpenet.github.io/alia/qbits.alia.timestamp-generator.html">timestamp-generator</a>  instance, or <code>:atomic-monotonic</code> , <code>:server-side</code> or <code>:thread-local</code>  which would translate in the underlying implementations.</p></li>
  <li>
  <p><code>:ssl?</code>: enables/disables SSL</p></li>
  <li>
  <p><code>:ssl-options</code> : advanced SSL setup using a  <code>com.datastax.driver.core.SSLOptions</code> instance or a map of  <code>:keystore-path</code>, <code>:keystore-password</code> and optional  <code>:cipher-suites</code>. This provides a path/pwd to a  <a href="http://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html">KeyStore</a>  that can ben generated  with <a href="http://docs.oracle.com/javase/7/docs/technotes/tools/solaris/keytool.html">keytool</a>  Overriding default cipher suites is supported via <code>:cipher-suites</code>,  which accepts a sequence of Strings.</p></li>
  <li>
  <p><code>:kerberos?</code> : activate Kerberos via DseAuthProvider, see  <a href="http://www.datastax.com/dev/blog/accessing-secure-dse-clusters-with-cql-native-protocol">http://www.datastax.com/dev/blog/accessing-secure-dse-clusters-with-cql-native-protocol</a></p></li>
  <li>
  <p><code>:pooling-options</code> : The pooling options used by this builder.  Options related to connection pooling.</p></li>
</ul>
<p>The driver uses connections in an asynchronous way. Meaning that  multiple requests can be submitted on the same connection at the  same time. This means that the driver only needs to maintain a  relatively small number of connections to each Cassandra host. These  options allow to control how many connections are kept exactly.</p>
<p>For each host, the driver keeps a core amount of connections open at  all time. If the utilisation of those connections reaches a  configurable threshold ,more connections are created up to a  configurable maximum number of connections.</p>
<p>Once more than core connections have been created, connections in  excess are reclaimed if the utilisation of opened connections drops  below the configured threshold.</p>
<p>Each of these parameters can be separately set for <code>:local</code> and <code>:remote</code>  hosts (HostDistance). For <code>:ignored</code> hosts, the default for all those  settings is 0 and cannot be changed.</p>
<p>Each of the following configuration keys, take a map of {distance value} :  ex:  <code>clojure
  :core-connections-per-host {:remote 10 :local 100}
</code></p>
<ul>
  <li><code>:core-connections-per-host</code> Number</li>
  <li><code>:max-connections-per-host</code> Number</li>
  <li><code>:max-requests-per-connection</code> Number</li>
  <li><code>:max-queue-size</code> Number</li>
  <li><code>:pool-timeout-millis</code> Number</li>
  <li><code>:connection-thresholds</code> [[host-distance-kw value]+]</li>
  <li>
    <p><code>:socket-options</code>: a map of</p>
    <ul>
      <li><code>:connect-timeout</code> Number</li>
      <li><code>:read-timeout</code> Number</li>
      <li><code>:receive-buffer-size</code> Number</li>
      <li><code>:send-buffer-size</code> Number</li>
      <li><code>:so-linger</code> Number</li>
      <li><code>:tcp-no-delay?</code> Bool</li>
      <li><code>:reuse-address?</code> Bool</li>
      <li><code>:keep-alive?</code> Bool</li>
    </ul>
  </li>
  <li>
    <p><code>:query-options</code>: a map of</p>
    <ul>
      <li><code>:fetch-size</code> Number</li>
      <li><code>:consistency</code> (consistency Keyword)</li>
      <li><code>:serial-consistency</code> (consistency Keyword)</li>
    </ul>
  </li>
  <li>
  <p><code>:jmx-reporting?</code> Bool, enables/disables JMX reporting of the metrics.</p></li>
</ul>
<p>The handling of these options is achieved with a multimethod that you  could extend if you need to handle some special case or want to create  your own options templates.  See <code>qbits.alia.cluster-options/set-cluster-option!</code> <a href="../src/qbits/alia/cluster_options.clj#L19">source</a></p>
<p>The handling of the individual policy options is achieved with a multimethod  in each of the policy namespaces that you could extend if you need to handle  some special case or want to create your own policy options template.  See - <code>qbits.alia.policy.load-balancing/make</code>  - <code>qbits.alia.policy.reconnection/make</code>  - <code>qbits.alia.policy.retry/make</code>  - <code>qbits.alia.policy.speculative-execution/make</code></p>
<p>Values for consistency:</p>
<p>:all :any :each-quorum :local-one :local-quorum :local-serial :one :quorum :serial :three :two</p>
<p>Values for time-unit:</p>
<p>:days :hours :microseconds :milliseconds :minutes :nanoseconds :seconds</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L36">view source</a></div></div><div class="public anchor" id="var-connect"><h3>connect</h3><div class="usage"><code>(connect cluster keyspace)</code><code>(connect cluster)</code></div><div class="doc"><div class="markdown"><p>Returns a new com.datastax.driver.core/Session instance. We need to have this separate in order to allow users to connect to multiple keyspaces from a single cluster instance</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L263">view source</a></div></div><div class="public anchor" id="var-execute"><h3>execute</h3><div class="usage"><code>(execute session query {:keys [consistency serial-consistency routing-key retry-policy result-set-fn row-generator tracing? idempotent? paging-state fetch-size values timestamp read-timeout codec]})</code><code>(execute session query)</code></div><div class="doc"><div class="markdown"><p>Executes a query against a session.  Returns a collection of rows.</p>
<p>The query can be a raw string, a PreparedStatement (returned by  <code>prepare</code>) with values passed via the <code>:values</code> option key will be bound by  <code>execute</code>, BoundStatement (returned by <code>qbits.alia/bind</code>).</p>
<p>The following options are supported:</p>
<ul>
  <li><code>:values</code> : values to be bound to a prepared query</li>
  <li><code>:consistency</code> : Keyword, consistency</li>
  <li><code>:serial-consistency</code> : Keyword, consistency</li>
  <li><code>:routing-key</code> : ByteBuffer</li>
  <li><code>:retry-policy</code> : one of qbits.alia.policy.retry/*</li>
  <li><code>:tracing?</code> : Bool, toggles query tracing (available via query result metadata)</li>
  <li><code>:fetch-size</code> : Number, sets query fetching size</li>
  <li><code>:timestamp</code> : Number, sets the timestamp for query (if not specified in CQL)</li>
  <li><code>:idempotent?</code> : Whether this statement is idempotent, i.e. whether  it can be applied multiple times without changing the result beyond  the initial application</li>
  <li><code>:paging-state</code> : Expects a com.datastax.driver.core.PagingState  instance. This will cause the next execution of this statement to  fetch results from a given page, rather than restarting from the  beginning</li>
  <li><code>:result-set-fn</code> : Defaults to <code>clojure.core/seq</code> By default a  result-set is an unchunked lazy seq, you can control this using this  option. If you pass a function that supports IReduceInit you can  have full control over how the resultset is formed (chunked,  unchunked, eager or not, etc). A common use is to pass <code>#(into [] %)</code>  as result-set-fn, you then get an eager value, with minimal copies,  no intermediary seq and potentially better performance. This can be  very powerfull when used right (for instance with transducers  <code>#(into [] xform %))</code>.</li>
  <li><code>:row-generator</code> : implements alia.codec/RowGenerator, Defaults to  <code>alia.codec/row-gen-&gt;map</code> : A RowGenerator dicts how we construct rows.</li>
  <li><code>:codec</code> : map of <code>:encoder</code> <code>:decoder</code> functions that control how to  apply extra modifications on data sent/received (defaults to  <code>qbits.alia.codec/default</code>).</li>
  <li><code>:read-timeout</code> : Read timeout in milliseconds</li>
</ul>
<p>Possible values for consistency:</p>
<p>:all :any :each-quorum :local-one :local-quorum :local-serial :one :quorum :serial :three :two</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L410">view source</a></div></div><div class="public anchor" id="var-execute-async"><h3>execute-async</h3><div class="usage"><code>(execute-async session query {:keys [executor consistency serial-consistency routing-key retry-policy result-set-fn row-generator codec tracing? idempotent? fetch-size values timestamp paging-state read-timeout success error]})</code><code>(execute-async session query)</code></div><div class="doc"><div class="markdown"><p>Same execute but async and takes optional :success and :error callback functions via options. For options refer to <code>qbits.alia/execute</code> doc</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L478">view source</a></div></div><div class="public anchor" id="var-lazy-query"><h3>lazy-query</h3><div class="usage"><code>(lazy-query session query pred opts)</code><code>(lazy-query session query pred)</code></div><div class="doc"><div class="markdown"><p>Takes a session, a query (raw or prepared) and a query modifier fn (that receives the last query and last chunk and returns a new query or nil). The first chunk will be the original query result, then for each subsequent chunk the query will be the result of last query modified by the modifier fn unless the fn returns nil, which would causes the iteration to stop.</p>
<p>It also accepts any of <code>execute</code> options.</p>
<p>ex: (lazy-query session  (select :items (limit 2) (where {:x (int 1)}))  (fn [q coll]  (merge q (where {:si (-&gt; coll last :x inc)})))  {:consistency :quorum :tracing? true})</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L527">view source</a></div></div><div class="public anchor" id="var-prepare"><h3>prepare</h3><div class="usage"><code>(prepare session query)</code></div><div class="doc"><div class="markdown"><p>Takes a session and a query (raw string or hayt) and returns a com.datastax.driver.core.PreparedStatement instance to be used in <code>execute</code> after it’s been bound with <code>bind</code>. Hayt query parameter will be compiled with qbits.hayt/-&gt;raw internaly ex: (prepare session (select :foo (where {:bar ?})))</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L353">view source</a></div></div><div class="public anchor" id="var-register.21"><h3>register!</h3><div class="usage"><code>(register! cluster latency-tracker)</code></div><div class="doc"><div class="markdown"><p>Register querylogger/latency tracker to cluster</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L547">view source</a></div></div><div class="public anchor" id="var-shutdown"><h3>shutdown</h3><div class="usage"><code>(shutdown x)</code></div><div class="doc"><div class="markdown"><p>Shutdowns Session or Cluster instance, clearing the underlying pools/connections</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L272">view source</a></div></div><div class="public anchor" id="var-tuple-encoder"><h3>tuple-encoder</h3><div class="usage"><code>(tuple-encoder session table column)</code><code>(tuple-encoder session ks table column)</code><code>(tuple-encoder session ks table column codec)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L565">view source</a></div></div><div class="public anchor" id="var-udt-encoder"><h3>udt-encoder</h3><div class="usage"><code>(udt-encoder session type)</code><code>(udt-encoder session ks type)</code><code>(udt-encoder session ks type codec)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L557">view source</a></div></div><div class="public anchor" id="var-unregister.21"><h3>unregister!</h3><div class="usage"><code>(unregister! cluster latency-tracker)</code></div><div class="doc"><div class="markdown"><p>Unregister querylogger/latency tracker from cluster</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia.clj#L552">view source</a></div></div></div></body></html>