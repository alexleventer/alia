<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>qbits.alia.policy.speculative-execution documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Alia-all</span> <span class="project-version">4.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>qbits</span></div></div></li><li class="depth-2"><a href="qbits.alia.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>alia</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>async</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.cluster-options.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cluster-options</span></div></a></li><li class="depth-3"><a href="qbits.alia.codec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>codec</span></div></a></li><li class="depth-4 branch"><a href="qbits.alia.codec.default.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>default</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extension</span></div></div></li><li class="depth-5"><a href="qbits.alia.codec.extension.joda-time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>joda-time</span></div></a></li><li class="depth-4"><a href="qbits.alia.codec.udt-aware.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>udt-aware</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.enum.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>enum</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.manifold.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>manifold</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>policy</span></div></div></li><li class="depth-4 branch"><a href="qbits.alia.policy.address-translator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>address-translator</span></div></a></li><li class="depth-4 branch"><a href="qbits.alia.policy.load-balancing.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>load-balancing</span></div></a></li><li class="depth-4 branch"><a href="qbits.alia.policy.reconnection.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>reconnection</span></div></a></li><li class="depth-4 branch"><a href="qbits.alia.policy.retry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>retry</span></div></a></li><li class="depth-4 current"><a href="qbits.alia.policy.speculative-execution.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>speculative-execution</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.query-logger.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>query-logger</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.timestamp-generator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>timestamp-generator</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.tuple.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tuple</span></div></a></li><li class="depth-3 branch"><a href="qbits.alia.udt.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>udt</span></div></a></li><li class="depth-3"><a href="qbits.alia.uuid.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>uuid</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="qbits.alia.policy.speculative-execution.html#var-cluster-wide-percentile-tracker"><div class="inner"><span>cluster-wide-percentile-tracker</span></div></a></li><li class="depth-1"><a href="qbits.alia.policy.speculative-execution.html#var-constant-speculative-execution-policy"><div class="inner"><span>constant-speculative-execution-policy</span></div></a></li><li class="depth-1"><a href="qbits.alia.policy.speculative-execution.html#var-make"><div class="inner"><span>make</span></div></a></li><li class="depth-1"><a href="qbits.alia.policy.speculative-execution.html#var-map-.3Econstant-speculative-execution-policy"><div class="inner"><span>map-&gt;constant-speculative-execution-policy</span></div></a></li><li class="depth-1"><a href="qbits.alia.policy.speculative-execution.html#var-map-.3Epercentile-speculative-execution-policy"><div class="inner"><span>map-&gt;percentile-speculative-execution-policy</span></div></a></li><li class="depth-1"><a href="qbits.alia.policy.speculative-execution.html#var-no-speculative-execution-policy"><div class="inner"><span>no-speculative-execution-policy</span></div></a></li><li class="depth-1"><a href="qbits.alia.policy.speculative-execution.html#var-per-host-percentile-tracker"><div class="inner"><span>per-host-percentile-tracker</span></div></a></li><li class="depth-1"><a href="qbits.alia.policy.speculative-execution.html#var-percentile-speculative-execution-policy"><div class="inner"><span>percentile-speculative-execution-policy</span></div></a></li><li class="depth-1"><a href="qbits.alia.policy.speculative-execution.html#var-percentile-tracker"><div class="inner"><span>percentile-tracker</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">qbits.alia.policy.speculative-execution</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-cluster-wide-percentile-tracker"><h3>cluster-wide-percentile-tracker</h3><div class="usage"><code>(cluster-wide-percentile-tracker {:keys [highest-trackable-latency-millis], :as opts})</code></div><div class="doc"><div class="markdown"><p>A <code>PercentileTracker</code> that aggregates all measurements into a single histogram.</p>
<p>This gives you global latency percentiles for the whole cluster, meaning that latencies of slower hosts will tend to appear in higher percentiles.</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia/policy/speculative_execution.clj#L62">view source</a></div></div><div class="public anchor" id="var-constant-speculative-execution-policy"><h3>constant-speculative-execution-policy</h3><div class="usage"><code>(constant-speculative-execution-policy constant-delay-ms max-speculative-executions)</code></div><div class="doc"><div class="markdown"><p>A SpeculativeExecutionPolicy that schedules a given number of speculative executions, separated by a fixed delay.</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia/policy/speculative_execution.clj#L14">view source</a></div></div><div class="public anchor" id="var-make"><h3>make</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia/policy/speculative_execution.clj#L83">view source</a></div></div><div class="public anchor" id="var-map-.3Econstant-speculative-execution-policy"><h3>map-&gt;constant-speculative-execution-policy</h3><div class="usage"><code>(map-&gt;constant-speculative-execution-policy {:keys [constant-delay-millis max-speculative-executions]})</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia/policy/speculative_execution.clj#L85">view source</a></div></div><div class="public anchor" id="var-map-.3Epercentile-speculative-execution-policy"><h3>map-&gt;percentile-speculative-execution-policy</h3><div class="usage"><code>(map-&gt;percentile-speculative-execution-policy tracker {:keys [percentile max-executions]})</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia/policy/speculative_execution.clj#L90">view source</a></div></div><div class="public anchor" id="var-no-speculative-execution-policy"><h3>no-speculative-execution-policy</h3><div class="usage"><code>(no-speculative-execution-policy)</code></div><div class="doc"><div class="markdown"><p>A SpeculativeExecutionPolicy that never schedules speculative executions.</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia/policy/speculative_execution.clj#L31">view source</a></div></div><div class="public anchor" id="var-per-host-percentile-tracker"><h3>per-host-percentile-tracker</h3><div class="usage"><code>(per-host-percentile-tracker {:keys [highest-trackable-latency-millis], :as opts})</code></div><div class="doc"><div class="markdown"><p>A <code>PercentileTracker</code> that maintains a separate histogram for each host.</p>
<p>This gives you per-host latency percentiles, meaning that each host will only be compared to itself.</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia/policy/speculative_execution.clj#L73">view source</a></div></div><div class="public anchor" id="var-percentile-speculative-execution-policy"><h3>percentile-speculative-execution-policy</h3><div class="usage"><code>(percentile-speculative-execution-policy percentile-tracker percentile max-speculative-executions)</code></div><div class="doc"><div class="markdown"><p>A policy that triggers speculative executions when the request to the current host is above a given percentile. This class uses a PerHostPercentileTracker that must be registered with the cluster instance</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia/policy/speculative_execution.clj#L21">view source</a></div></div><div class="public anchor" id="var-percentile-tracker"><h3>percentile-tracker</h3><div class="usage"><code>(percentile-tracker builder {:keys [interval min-recorded-values significant-value-digits]})</code></div><div class="doc"><div class="markdown"><p>A <code>LatencyTracker</code> that records query latencies over a sliding time interval, and exposes an API to retrieve the latency at a given percentile.</p>
<p>It uses <code>HdrHistogram</code> to record latencies: for each category, there is a “live” histogram where current latencies are recorded, and a “cached”, read-only histogram that is used when clients call <code>getLatencyAtPercentile(Host, Statement, Exception, double)</code>. Each time the cached histogram becomes older than the interval, the two histograms are switched. Statistics will not be available during the first interval at cluster startup, since we don’t have a cached histogram yet.</p></div></div><div class="src-link"><a href="https://github.com/mpenet/alia/blob/master/modules/alia/src/qbits/alia/policy/speculative_execution.clj#L36">view source</a></div></div></div></body></html>